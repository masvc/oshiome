# 推しおめ

## サービス概要

推し（Vtuber、アイドル等）の誕生日を祝うためのクラウドファンディングプラットフォーム。
ファンが連携して駅広告やデジタルサイネージなどにお誕生日広告を出すことのできるサービス。

## 登場人物

- 企画者：推しの誕生日企画を立ち上げたい人
- ユーザー：企画に参加して支援する人
- アドミン：サービスの管理者（運営側）

## 主な機能

### 1. 誕生日企画の作成・支援

- 企画者が企画を申請（事務所承認と前金が必要）
- 承認された企画がプラットフォームに掲載
- ユーザーは掲載期間中に支援可能
- 企画例：
  - 駅広告（渋谷、新宿などの駅構内の広告）
  - 新聞広告
  - デジタルサイネージ（街頭ビジョンなど）

### 2. 決済機能

- 支援金額は企画ごとに一律
- リアルタイムで支援総額を表示
- 決済方法：
  - クレジットカード（Stripe 決済）
  - その他決済手段（PayPay も企画者が QR コードや ID 連携したらできるかも）

## ユーザーの利用の流れ

### 企画者の場合

1. 無料相談の申請

   - アドミンとチャットで企画内容を相談
   - 事務所への承諾手配
   - 前金の振り込み

2. 企画の作成

   - 企画者アカウントの発行
   - 企画情報の入力
   - 企画ページの公開

3. 支援募集期間

   - SNS などで支援を呼びかけ
   - 支援状況のモニタリング

4. 企画実施

   - 集まった資金から手数料を除いた予算で広告実施
   - デザインの用意（外注可）
   - 余剰金・前金の返金

5. 企画終了
   - 実施レポートの作成
   - 次回に向けたメルマガ配信設定

### 支援ユーザーの場合

1. 企画ページの閲覧
2. 支援金額の確認
3. 決済手続き
4. 企画の進捗確認

## 技術スタック

### フロントエンド（ユーザーが見る画面の開発）

- React

  - Web サイトの見た目を作るための技術
  - 部品（コンポーネント）を組み合わせて画面を構築
  - 例：ボタン、フォーム、カード型の表示など

- TailwindCSS
  - ユーティリティファーストの CSS フレームワーク
  - コンポーネントベースの開発に最適
  - カスタムデザインシステムの実装
    - カラーパレット（oshi-pink, oshi-purple など）
    - レスポンシブデザイン
    - アニメーション効果

### バックエンド（システムの裏側の開発）

- Supabase
  - データの保存や認証などの機能を提供
  - 主な機能：
    - ユーザー管理（ログインなど）
    - データベース（情報の保存）
    - ファイル保存（画像など）
    - サーバー処理（決済など）

### 開発環境

- Docker
  - 開発環境を簡単に準備するためのツール
  - チーム全員が同じ環境で開発可能
  - コマンド 1 つで環境構築が完了

## プロジェクトの構成

```
oshiome/
├── frontend/           # 画面の見た目に関するコード
│   ├── components/     # 再利用可能な部品
│   ├── pages/         # 各ページの画面
│   └── features/      # 機能ごとのまとまり
├── supabase/          # データベースや認証の設定
└── shared/            # 共通で使用するコード
```

## 参考情報

- 参考サイト：<https://train-ad.net/>
- 連携先：<https://accacom.jp/alliance-fmc/>
- 類似サービス：センイル広告（Vtuber、アイドルの生誕祭広告）

## 実装スケジュール

### フェーズ 1：開発環境セットアップ

開発を始める前の準備段階です。チームで同じ環境で開発できるように設定を行います。

- [✔︎] GitHub（コードを共有・管理するための場所を準備）

  - [✔︎] リポジトリの作成
    - チームでコードを共有する場所を作ります
    - コードの変更履歴も全て記録されます
  - [？] main ブランチの保護設定
    - 本番環境で使うコードを間違って変更しないように保護します
    - 必ず他の人のレビューを受けてから反映されるようにします
  - [✔︎] プルリクエストテンプレートの作成
    - コードレビューをお願いする時の説明テンプレートを作ります
    - 何を変更したのか、どうテストしたのかなどを書く場所です

- [✔️] React 環境（画面を作るための準備）

  - [✔️] vite を活用してプロジェクト作成
    - React の基本的なファイル一式を自動生成します
    - 必要な設定も自動で行われます
  - [✔️] ESLint + Prettier の設定
    - コードの書き方を統一するルールを設定します
    - インデントや改行などが自動で整形されます
    - コードを書く際は、定期的に `npm run format` と `npm run lint` を実行して、コードの品質を保つことができます

- [✔︎] Supabase（データベースと認証の準備）

  - [✔︎] プロジェクトの作成
    - Supabase のウェブサイトで新しいプロジェクトを作ります
    - データベースとユーザー認証の機能が使えるようになります
  - [✔︎] 環境変数の設定（.env）
    - Supabase の URL や API キーを安全に保管します
    - パスワードのような重要な情報を管理する場所です

- [✔︎] Docker 環境（全員が同じ開発環境を使えるようにする）

  - [✔︎] Dockerfile 作成
    - アプリケーションを動かすための設定ファイルです
    - Node.js のバージョンなどを指定します
  - [✔︎] docker-compose.yml 作成
    - 開発環境の全体設定ファイルです
    - ポート番号やファイルの場所などを指定します
  - [✔︎] .dockerignore の設定
    - Docker に含めない不要なファイルを指定します
    - node_modules など、自動生成されるファイルは除外します

  開発の際は `docker compose up` で開発サーバーを起動します。
  本番用ビルドが必要な時は `docker compose run --rm frontend npm run build` を実行します

- [✔︎] CI/CD（自動チェックと自動デプロイの設定）
  - [✔︎] GitHub Actions の設定
    - [✔︎] 自動テスト実行
      - コードを変更するたびに自動でテストが実行されます
      - バグを早期に発見できます
    - [✔︎] コード品質チェック
      - ESLint でコードの書き方をチェックします
      - Prettier で自動的にコードを整形します
    - [✔︎] ビルドテスト
      - アプリが正しくビルドできるか確認します
      - 本番環境で動作する前に問題を見つけられます
  - [✔︎] Vercel での自動デプロイ設定
    - [✔︎] プレビュー環境の設定
      - プルリクエスト時に確認用サイトを自動作成
      - 変更内容を実際のサイトで確認できます
    - [✔︎] 本番環境の設定
      - main ブランチの更新で自動デプロイ
      - 手動での作業ミスを防げます
    - [✔︎] デプロイ時の注意点
      - Vercel の設定は極力ダッシュボードで管理（設定の一元化）
      - Root Directory は`frontend`を指定
      - 環境変数の設定は 2 種類
        1. GitHub Actions 用の環境変数（GitHub Secrets に設定）
           - `VERCEL_TOKEN`：Vercel の認証トークン
           - `VERCEL_ORG_ID`：組織 ID
           - `VERCEL_PROJECT_ID`：プロジェクト ID
        2. アプリケーション用の環境変数（Vercel ダッシュボードに設定）
           - `VITE_SUPABASE_URL`：Supabase のプロジェクトのデータベース接続 URL
           - `VITE_SUPABASE_ANON_KEY`：Supabase の公開認証キー
             ※ 設定忘れると白い画面になるので要注意！
      - GitHub Actions のワークフローでは Vercel の設定と競合しないよう注意
        - `working-directory`の指定はビルド時のみに限定
        - デプロイ時の設定は Vercel ダッシュボードに委ねる
      - 日本語のコミットメッセージに対応するための Git 設定が必要
      - トラブルシューティング
        - 白い画面が表示される場合は環境変数の設定を確認
        - デプロイ後は必ず Vercel ダッシュボードでビルドログを確認

### フェーズ 2：最小限の機能実装（MVP）

サービスの核となる機能を最初に作ります。MVP とは「必要最小限の機能を持つ製品」という意味です。

- [ ] 認証機能（ログイン関連の機能）

  - [✔︎] Supabase Auth の設定
    - ユーザー名とメールアドレスとパスワードでユーザー登録できるようにします
    - 上記情報から supabase の認証用ユーザーとユーザープロファイル用のテーブル登録します
  - [✔︎] ログインページの作成
    - ユーザーがログインするための画面を作ります
    - メールアドレスとパスワードでログインできるようにします
  - [ ] ログアウトの実装
    - メイン画面に暫定のログアウトボタンを追加します。
    - ログアウト機能を追加します。

- [ ] データベース（情報を保存する場所）

  - [✔︎] ユーザーテーブルの作成
    - ユーザーの情報（名前、メールアドレスなど）を保存する場所
  - [ ] 企画テーブルの作成
    - 誕生日企画の情報（タイトル、目標金額など）を保存する場所
  - [ ] 支援テーブルの作成
    - 誰がどの企画にいくら支援したかを記録する場所

- [ ] 画面実装（ユーザーが使う画面の作成）

  - [] ホーム画面
    - サービスのトップページを作成完了
    - 現在進行中の企画一覧の表示を実装
  - [] 企画一覧ページ
    - 全ての企画を一覧で表示する画面を実装完了
  - [ ] 企画詳細ページ
    - 企画の詳しい情報を表示する画面を作成中
    - 支援ボタンの配置はこれから
  - [ ] 支援フォーム
    - 支援金額入力と決済画面はこれから実装予定

- [ ] 決済機能（お金の支払い機能）
  - [ ] Stripe アカウント作成
    - クレジットカード決済を扱うサービスに登録します
  - [ ] テスト決済の実装
    - テスト用のカード番号で決済できるようにします
    - 本物のお金は使わずにテストできます

### フェーズ 3：デプロイ（サービスを公開する）

作ったサービスをインターネット上で公開できるようにします。

- [ ] Vercel の動作確認
  - 自動デプロイされたサイトが正しく動くかチェック
  - 本番環境での動作確認
- [ ] エラー監視の設定
  - 本番環境でエラーが発生した時に通知を受け取れるように
- [ ] パフォーマンスの確認
  - 表示速度や動作の確認
  - 必要に応じて改善

### 後回し機能（あとで追加する機能）

最初は作らないけど、将来的に追加したい機能のリストです。

- 管理者向けの特別な機能
- 画像をアップロードする機能
- メールでの通知機能
- SNS でシェアする機能
- 自動テスト機能

### 追加要件

- 事務所の承諾有無の項目追加  
  →（企画テーブルに項目追加します）
- 企画の支援合計金額の算出  
  → 別テーブルではなく支援テーブルの金額を SUM 関数を使って算出する方向で検討中。
